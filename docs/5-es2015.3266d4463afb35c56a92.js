(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{lE2P:function(t,e,c){"use strict";c.r(e),c.d(e,"ProductModule",(function(){return it}));var r=c("tyNb"),o=c("PCNd"),s=c("fXoL"),d=c("kt0X");const i=Object(d.n)("[Product] Toggle Product Code"),n=Object(d.n)("[Product] Set Current Product",Object(d.s)()),a=Object(d.n)("[Product] Clear Current Product"),b=Object(d.n)("[Product] Initialize Current Product"),u=Object(d.n)("[Product] Load"),l=Object(d.n)("[Product] Load Success",Object(d.s)()),p=Object(d.n)("[Product] Load Fail",Object(d.s)()),g=Object(d.n)("[Product] Update Product",Object(d.s)()),h=Object(d.n)("[Product] Update Product Success",Object(d.s)()),f=Object(d.n)("[Product] Update Product Fail",Object(d.s)()),m=Object(d.n)("[Product] Delete Product",Object(d.s)()),O=Object(d.n)("[Product] Delete Product Success",Object(d.s)()),j=Object(d.n)("[Product] Delete Product Fail",Object(d.s)()),P=Object(d.n)("[Product] Create Product",Object(d.s)()),C=Object(d.n)("[Product] Create Product Success",Object(d.s)()),v=Object(d.n)("[Product] Create Product Fail",Object(d.s)()),R=Object(d.o)("products"),y=Object(d.q)(R,t=>t.showProductCode),Q=Object(d.q)(R,t=>t.currentProductId),I=Object(d.q)(R,Q,(t,e)=>0===e?{id:0,productName:"",productCode:"New",description:"",starRating:0}:e?t.products.find(t=>t.id===e):null),M=Object(d.q)(R,t=>t.products),w=Object(d.q)(R,t=>t.error),$=Object(d.p)({showProductCode:!0,currentProductId:null,products:[],error:""},Object(d.r)(i,t=>Object.assign(Object.assign({},t),{showProductCode:!t.showProductCode})),Object(d.r)(n,(t,e)=>Object.assign(Object.assign({},t),{currentProductId:e.currentProductId})),Object(d.r)(a,t=>Object.assign(Object.assign({},t),{currentProductId:null})),Object(d.r)(b,t=>Object.assign(Object.assign({},t),{currentProductId:0})),Object(d.r)(l,(t,e)=>Object.assign(Object.assign({},t),{products:e.products,error:""})),Object(d.r)(p,(t,e)=>Object.assign(Object.assign({},t),{error:e.error})),Object(d.r)(h,(t,e)=>{const c=t.products.map(t=>e.product.id===t.id?e.product:t);return Object.assign(Object.assign({},t),{products:c,currentProductId:e.product.id,error:""})}),Object(d.r)(f,(t,e)=>Object.assign(Object.assign({},t),{error:e.error})),Object(d.r)(O,(t,e)=>Object.assign(Object.assign({},t),{products:t.products.filter(t=>t.id!==e.id),currentProductId:null,error:""})),Object(d.r)(j,(t,e)=>Object.assign(Object.assign({},t),{error:e.error})),Object(d.r)(C,(t,e)=>Object.assign(Object.assign({},t),{products:[...t.products,e.product],currentProductId:e.product.id,error:""})),Object(d.r)(v,(t,e)=>Object.assign(Object.assign({},t),{error:e.error})));var N=c("ofXK");function k(t,e){if(1&t&&(s.Pb(0),s.mc(1),s.Ob()),2&t){const t=s.bc().$implicit;s.Cb(1),s.oc(" (",t.productCode,") ")}}const F=function(t){return{active:t}};function S(t,e){if(1&t){const t=s.Sb();s.Rb(0,"button",13),s.Zb("click",(function(){s.ic(t);const c=e.$implicit;return s.bc(2).productSelected(c)})),s.cc(1,"async"),s.mc(2),s.lc(3,k,2,1,"ng-container",14),s.cc(4,"async"),s.Qb()}if(2&t){const t=e.$implicit,r=s.bc(2);var c;const o=s.fc(7,F,(null==t?null:t.id)===(null==(c=s.dc(1,3,r.selectedProduct$))?null:c.id));s.ec("ngClass",o),s.Cb(2),s.oc("",t.productName," "),s.Cb(1),s.ec("ngIf",s.dc(4,5,r.displayCode$))}}function x(t,e){if(1&t&&(s.Rb(0,"div",10),s.Rb(1,"div",11),s.lc(2,S,5,9,"button",12),s.cc(3,"async"),s.Qb(),s.Qb()),2&t){const t=s.bc();s.Cb(2),s.ec("ngForOf",s.dc(3,1,t.products$))}}function E(t,e){if(1&t&&(s.Rb(0,"div",15),s.mc(1),s.Qb()),2&t){const t=e.ngIf;s.Cb(1),s.oc(" Error: ",t,"\n")}}let q=(()=>{class t{constructor(t){this.store=t,this.pageTitle="Products"}ngOnInit(){this.products$=this.store.select(M),this.errorMessage$=this.store.select(w),this.store.dispatch(u()),this.selectedProduct$=this.store.select(I),this.displayCode$=this.store.select(y)}checkChanged(){this.store.dispatch(i())}newProduct(){this.store.dispatch(b())}productSelected(t){this.store.dispatch(n({currentProductId:t.id}))}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(d.h))},t.\u0275cmp=s.Gb({type:t,selectors:[["pm-product-list"]],decls:17,vars:10,consts:[[1,"card"],[1,"card-header"],["class","card-body",4,"ngIf"],[1,"card-footer"],[1,"row"],[1,"form-check","col-md-7"],["type","checkbox",1,"form-check-input",3,"checked","change"],[1,"col-md-4","text-right"],[1,"btn","btn-primary",3,"click"],["class","alert alert-danger",4,"ngIf"],[1,"card-body"],[1,"list-group"],["class","list-group-item list-group-item-action rounded-0",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"list-group-item","list-group-item-action","rounded-0",3,"ngClass","click"],[4,"ngIf"],[1,"alert","alert-danger"]],template:function(t,e){1&t&&(s.Rb(0,"div",0),s.Rb(1,"div",1),s.mc(2),s.Qb(),s.lc(3,x,4,3,"div",2),s.cc(4,"async"),s.Rb(5,"div",3),s.Rb(6,"div",4),s.Rb(7,"div",5),s.Rb(8,"label"),s.Rb(9,"input",6),s.Zb("change",(function(){return e.checkChanged()})),s.cc(10,"async"),s.Qb(),s.mc(11," Display Product Code "),s.Qb(),s.Qb(),s.Rb(12,"div",7),s.Rb(13,"button",8),s.Zb("click",(function(){return e.newProduct()})),s.mc(14," Add "),s.Qb(),s.Qb(),s.Qb(),s.Qb(),s.Qb(),s.lc(15,E,2,1,"div",9),s.cc(16,"async")),2&t&&(s.Cb(2),s.oc(" ",e.pageTitle," "),s.Cb(1),s.ec("ngIf",s.dc(4,4,e.products$)),s.Cb(6),s.ec("checked",s.dc(10,6,e.displayCode$)),s.Cb(6),s.ec("ngIf",s.dc(16,8,e.errorMessage$)))},directives:[N.k,N.j,N.i],pipes:[N.b],styles:[".card-body[_ngcontent-%COMP%]{padding:0}"]}),t})();var T=c("3Pt+");class Z{constructor(t){this.validationMessages=t}processMessages(t){const e={};for(const c in t.controls)if(t.controls.hasOwnProperty(c)){const r=t.controls[c];if(r instanceof T.d){const t=this.processMessages(r);Object.assign(e,t)}else this.validationMessages[c]&&(e[c]="",(r.dirty||r.touched)&&r.errors&&Object.keys(r.errors).map(t=>{this.validationMessages[c][t]&&(e[c]+=this.validationMessages[c][t]+" ")}))}return e}}class U{static range(t,e){return c=>c.value&&(isNaN(c.value)||c.value<t||c.value>e)?{range:!0}:null}}var D=c("vkgz"),J=c("tk/3"),L=c("z6cu"),V=c("JIr8"),G=c("lJxs");let z=(()=>{class t{constructor(t){this.http=t,this.productsUrl="api/products"}getProducts(){return this.http.get(this.productsUrl).pipe(Object(D.a)(t=>console.log(JSON.stringify(t))),Object(V.a)(this.handleError))}createProduct(t){const e=new J.d({"Content-Type":"application/json"}),c=Object.assign(Object.assign({},t),{id:null});return this.http.post(this.productsUrl,c,{headers:e}).pipe(Object(D.a)(t=>console.log("createProduct: "+JSON.stringify(t))),Object(V.a)(this.handleError))}deleteProduct(t){const e=new J.d({"Content-Type":"application/json"});return this.http.delete(`${this.productsUrl}/${t}`,{headers:e}).pipe(Object(D.a)(e=>console.log("deleteProduct: "+t)),Object(V.a)(this.handleError))}updateProduct(t){const e=new J.d({"Content-Type":"application/json"});return this.http.put(`${this.productsUrl}/${t.id}`,t,{headers:e}).pipe(Object(D.a)(()=>console.log("updateProduct: "+t.id)),Object(G.a)(()=>t),Object(V.a)(this.handleError))}handleError(t){let e;return e=t.error instanceof ErrorEvent?"An error occurred: "+t.error.message:`Backend returned code ${t.status}: ${t.body.error}`,console.error(t),Object(L.a)(e)}}return t.\u0275fac=function(e){return new(e||t)(s.Vb(J.b))},t.\u0275prov=s.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function A(t,e){if(1&t&&(s.Rb(0,"span",22),s.mc(1),s.Qb()),2&t){const t=s.bc(2);s.Cb(1),s.oc(" ",t.displayMessage.productName," ")}}function X(t,e){if(1&t&&(s.Rb(0,"span",22),s.mc(1),s.Qb()),2&t){const t=s.bc(2);s.Cb(1),s.oc(" ",t.displayMessage.productCode," ")}}function K(t,e){if(1&t&&(s.Rb(0,"span",22),s.mc(1),s.Qb()),2&t){const t=s.bc(2);s.Cb(1),s.oc(" ",t.displayMessage.starRating," ")}}function B(t,e){if(1&t&&(s.Rb(0,"span",22),s.mc(1),s.Qb()),2&t){const t=s.bc(2);s.Cb(1),s.oc(" ",t.displayMessage.description," ")}}const _=function(t){return{"is-invalid":t}};function H(t,e){if(1&t){const t=s.Sb();s.Rb(0,"div",2),s.Rb(1,"div",3),s.mc(2),s.Qb(),s.Rb(3,"div",4),s.Rb(4,"form",5),s.Zb("ngSubmit",(function(){s.ic(t);const c=e.ngIf;return s.bc().saveProduct(c)})),s.Rb(5,"fieldset"),s.Rb(6,"div",6),s.Rb(7,"label",7),s.mc(8,"Product Name"),s.Qb(),s.Rb(9,"div",8),s.Rb(10,"input",9),s.Zb("blur",(function(){return s.ic(t),s.bc().blur()})),s.Qb(),s.lc(11,A,2,1,"span",10),s.Qb(),s.Qb(),s.Rb(12,"div",6),s.Rb(13,"label",11),s.mc(14,"Product Code"),s.Qb(),s.Rb(15,"div",8),s.Rb(16,"input",12),s.Zb("blur",(function(){return s.ic(t),s.bc().blur()})),s.Qb(),s.lc(17,X,2,1,"span",10),s.Qb(),s.Qb(),s.Rb(18,"div",6),s.Rb(19,"label",13),s.mc(20,"Star Rating (1-5)"),s.Qb(),s.Rb(21,"div",8),s.Nb(22,"input",14),s.lc(23,K,2,1,"span",10),s.Qb(),s.Qb(),s.Rb(24,"div",6),s.Rb(25,"label",15),s.mc(26,"Description"),s.Qb(),s.Rb(27,"div",8),s.Rb(28,"textarea",16),s.mc(29,"            "),s.Qb(),s.lc(30,B,2,1,"span",10),s.Qb(),s.Qb(),s.Rb(31,"div",17),s.Rb(32,"div",18),s.Rb(33,"span"),s.Rb(34,"button",19),s.mc(35," Save "),s.Qb(),s.Qb(),s.Rb(36,"span"),s.Rb(37,"button",20),s.Zb("click",(function(){return s.ic(t),s.bc().cancelEdit()})),s.mc(38," Cancel "),s.Qb(),s.Qb(),s.Rb(39,"span"),s.Rb(40,"button",21),s.Zb("click",(function(){s.ic(t);const c=e.ngIf;return s.bc().deleteProduct(c)})),s.mc(41," Delete "),s.Qb(),s.Qb(),s.Qb(),s.Qb(),s.Qb(),s.Qb(),s.Qb(),s.Qb()}if(2&t){const t=s.bc();s.Cb(2),s.oc(" ",t.pageTitle," "),s.Cb(2),s.ec("formGroup",t.productForm),s.Cb(6),s.ec("ngClass",s.fc(11,_,t.displayMessage.productName)),s.Cb(1),s.ec("ngIf",t.displayMessage.productName),s.Cb(5),s.ec("ngClass",s.fc(13,_,t.displayMessage.productCode)),s.Cb(1),s.ec("ngIf",t.displayMessage.productCode),s.Cb(5),s.ec("ngClass",s.fc(15,_,t.displayMessage.starRating)),s.Cb(1),s.ec("ngIf",t.displayMessage.starRating),s.Cb(5),s.ec("ngClass",s.fc(17,_,t.displayMessage.description)),s.Cb(2),s.ec("ngIf",t.displayMessage.description),s.Cb(4),s.ec("disabled",!t.productForm.valid||!t.productForm.dirty)}}function W(t,e){if(1&t&&(s.Rb(0,"div",23),s.mc(1),s.Qb()),2&t){const t=s.bc();s.Cb(1),s.oc(" Error: ",t.errorMessage,"\n")}}let Y=(()=>{class t{constructor(t,e,c){this.store=t,this.fb=e,this.productService=c,this.pageTitle="Product Edit",this.errorMessage="",this.displayMessage={},this.validationMessages={productName:{required:"Product name is required.",minlength:"Product name must be at least three characters.",maxlength:"Product name cannot exceed 50 characters."},productCode:{required:"Product code is required."},starRating:{range:"Rate the product between 1 (lowest) and 5 (highest)."}},this.genericValidator=new Z(this.validationMessages)}ngOnInit(){this.productForm=this.fb.group({productName:["",[T.m.required,T.m.minLength(3),T.m.maxLength(50)]],productCode:["",T.m.required],starRating:["",U.range(1,5)],description:""}),this.product$=this.store.select(I).pipe(Object(D.a)(t=>this.displayProduct(t))),this.productForm.valueChanges.subscribe(()=>this.displayMessage=this.genericValidator.processMessages(this.productForm))}blur(){this.displayMessage=this.genericValidator.processMessages(this.productForm)}displayProduct(t){t&&(this.productForm.reset(),this.pageTitle=0===t.id?"Add Product":"Edit Product: "+t.productName,this.productForm.patchValue({productName:t.productName,productCode:t.productCode,starRating:t.starRating,description:t.description}))}cancelEdit(){this.displayProduct(null),this.store.dispatch(a())}deleteProduct(t){t&&t.id?confirm(`Really delete the product: ${t.productName}?`)&&this.store.dispatch(m({id:t.id})):this.store.dispatch(a())}saveProduct(t){if(this.productForm.valid&&this.productForm.dirty){const e=Object.assign(Object.assign({},t),this.productForm.value);this.store.dispatch(0===e.id?P({product:e}):g({product:e}))}}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(d.h),s.Mb(T.b),s.Mb(z))},t.\u0275cmp=s.Gb({type:t,selectors:[["pm-product-edit"]],decls:3,vars:4,consts:[["class","card",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"card-body"],["novalidate","",3,"formGroup","ngSubmit"],[1,"form-group","row"],["for","productNameId",1,"col-md-3","col-form-label"],[1,"col-md-9"],["id","productNameId","type","text","placeholder","Name (required)","formControlName","productName",1,"form-control",3,"ngClass","blur"],["class","invalid-feedback",4,"ngIf"],["for","productCodeId",1,"col-md-3","col-form-label"],["id","productCodeId","type","text","placeholder","Code (required)","formControlName","productCode",1,"form-control",3,"ngClass","blur"],["for","starRatingId",1,"col-md-3","col-form-label"],["id","starRatingId","type","text","placeholder","Rating","formControlName","starRating",1,"form-control",3,"ngClass"],["for","descriptionId",1,"col-md-3","col-form-label"],["id","descriptionId","placeholder","Description","rows","3","formControlName","description",1,"form-control",3,"ngClass"],[1,"form-group"],[1,"col-md-10","col-md-offset-2"],["type","submit",1,"btn","btn-primary",2,"width","80px","margin-right","10px",3,"disabled"],["type","button",1,"btn","btn-light",2,"width","80px","margin-right","10px",3,"click"],["type","button",1,"btn","btn-light",2,"width","80px",3,"click"],[1,"invalid-feedback"],[1,"alert","alert-danger"]],template:function(t,e){1&t&&(s.lc(0,H,42,19,"div",0),s.cc(1,"async"),s.lc(2,W,2,1,"div",1)),2&t&&(s.ec("ngIf",s.dc(1,2,e.product$)),s.Cb(2),s.ec("ngIf",e.errorMessage))},directives:[N.k,T.n,T.h,T.e,T.a,T.g,T.c,N.i],pipes:[N.b],encapsulation:2}),t})(),tt=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Gb({type:t,selectors:[["ng-component"]],decls:5,vars:0,consts:[[1,"row"],[1,"col-md-4"],[1,"col-md-8"]],template:function(t,e){1&t&&(s.Rb(0,"div",0),s.Rb(1,"div",1),s.Nb(2,"pm-product-list"),s.Qb(),s.Rb(3,"div",2),s.Nb(4,"pm-product-edit"),s.Qb(),s.Qb())},directives:[q,Y],encapsulation:2}),t})();var et=c("snw9"),ct=c("LRne"),rt=c("5+tZ"),ot=c("bOdf");let st=(()=>{class t{constructor(t,e){this.actions$=t,this.productService=e,this.loadProducts$=Object(et.c)(()=>this.actions$.pipe(Object(et.d)(u),Object(rt.a)(()=>this.productService.getProducts().pipe(Object(G.a)(t=>l({products:t})),Object(V.a)(t=>Object(ct.a)(p({error:t}))))))),this.updateProduct$=Object(et.c)(()=>this.actions$.pipe(Object(et.d)(g),Object(ot.a)(t=>this.productService.updateProduct(t.product).pipe(Object(G.a)(t=>h({product:t})),Object(V.a)(t=>Object(ct.a)(f({error:t}))))))),this.deleteProduct$=Object(et.c)(()=>this.actions$.pipe(Object(et.d)(m),Object(rt.a)(t=>this.productService.deleteProduct(t.id).pipe(Object(G.a)(()=>O({id:t.id}),Object(V.a)(t=>Object(ct.a)(j({error:t})))))))),this.createProduct$=Object(et.c)(()=>this.actions$.pipe(Object(et.d)(P),Object(ot.a)(t=>this.productService.createProduct(t.product).pipe(Object(G.a)(t=>C({product:t}),Object(V.a)(t=>Object(ct.a)(v({error:t}))))))))}}return t.\u0275fac=function(e){return new(e||t)(s.Vb(et.a),s.Vb(z))},t.\u0275prov=s.Ib({token:t,factory:t.\u0275fac}),t})();const dt=[{path:"",component:tt}];let it=(()=>{class t{}return t.\u0275mod=s.Kb({type:t}),t.\u0275inj=s.Jb({factory:function(e){return new(e||t)},imports:[[o.a,r.d.forChild(dt),d.j.forFeature("products",$),et.b.forFeature([st])]]}),t})()}}]);